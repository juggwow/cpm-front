<div class="p-0 mt-3">
  <p class="font-bold text-2xl text-primar mb-4">บริหารสัญญา</p>
  <p-breadcrumb class="max-w-full" [model]="items" [style]="{background:'none',border:'none',padding:'0',margin: '0 0 1.5rem 0'}"></p-breadcrumb>
  <div class="card">
    <div class="flex flex-wrap justify-content-between align-items-center p-4 ">
      <p class="font-bold text-lg text-primar my-auto">รายการใบ Receive and Damage</p>
      <button class="btn btn-lg btn-primary px-5 p-button-outlined flex flex-wrap gap-3 justify-content-between align-items-center" pButton [routerLink]="['create']"><img src="./../../../assets/svg/create_document.svg" /><p>สร้างเอกสาร</p></button>
    </div>
    <div class="grid grid-nogutter px-5 p-4 surface-50 text-primar">
      <div class="col-12 mb-3 md:mb-0 md:col-8 flex flex-column">
        <p class="font-bold mb-0">อุปกรณ์ที่ส่งมอบ</p>
        <p class="my-auto">{{itemDetail.name}}</p>
      </div>
      <div class="col-12 mb-3 md:mb-0 md:col-2 flex flex-column">
        <p class="font-bold mb-0">จำนวนตามสัญญา</p>
        <p class="my-auto">{{itemDetail.contractQTY}}</p>
      </div>
      <div class="col-12 md:mb-0 md:col-2 flex flex-column">
        <p class="font-bold mb-0">จำนวนที่ส่งมอบแล้ว</p>
        <p class="my-auto">{{itemDetail.receiveQTY}}</p> 
      </div>
    </div>
    <div class="p-4">
      <p-table [value]="data" [rowHover]="true" [loading]="loading" [lazy]="true"
          (onSort)="onSortColumn($event)">
          <ng-template pTemplate="header">
            <tr>
              <th pSortableColumn="sortRowNo">
                <div class="flex justify-content-between align-items-center">
                  ลำดับ
                  <p-sortIcon field="sortRowNo"></p-sortIcon>
                </div>
              </th>
              <th pSortableColumn="sortInvNo">
                <div class="flex justify-content-between align-items-center">
                  เลขที่ใบส่ง
                  <p-sortIcon field="sortInvNo"></p-sortIcon>
                </div>
              </th>
              <th pSortableColumn="sortQuantity">
                <div class="flex justify-content-between align-items-center">
                  จำนวนรายการ
                  <p-sortIcon field="sortQuantity"></p-sortIcon>
                </div>
              </th>
              <th pSortableColumn="sortArrival">
                <div class="flex justify-content-between align-items-center">
                  วันที่ส่งถึงหน้างาน
                  <p-sortIcon field="sortArrival"></p-sortIcon>
                </div>
              </th>
              <th pSortableColumn="sortInspection">
                <div class="flex justify-content-between align-items-center">
                  วันที่ตรวจสอบ
                  <p-sortIcon field="sortInspection"></p-sortIcon>
                </div>
              </th>
              <th pSortableColumn="sortCreater">
                <div class="flex justify-content-between align-items-center">
                  ผู้สร้างเอกสาร
                  <p-sortIcon field="sortCreater"></p-sortIcon>
                </div>
              </th>
              <th pSortableColumn="sortStateName">
                <div class="flex justify-content-between align-items-center">
                  สถานะ
                  <p-sortIcon field="sortStateName"></p-sortIcon>
                </div>
              </th>

              <th></th>
            </tr>
            <tr>
              <th>
                <span class="p-input-icon-right">
                  <input #inputRowNo type="text" pInputText (keyup)="onFilterColumn('searchRowNo', $event)"
                    placeholder="Search" style="width: 5rem" />
                  <i *ngIf="inputRowNo.value" class="pi pi-times cursor-pointer"
                    (click)="inputRowNo.value = '';onClearFilter('searchRowNo')"></i>
                </span>
              </th>
              <th>
                <span class="p-input-icon-right">
                  <input #inputInvNo type="text" pInputText (keyup)="onFilterColumn('searchInvNo', $event)"
                    placeholder="Search" style="width: 5rem" />
                  <i *ngIf="inputInvNo.value" class="pi pi-times cursor-pointer"
                    (click)="inputInvNo.value = '';onClearFilter('searchInvNo')"></i>
                </span>
              </th>
              <th>
                <span class="p-input-icon-right">
                  <input #inputQuantity type="text" pInputText (keyup)="onFilterColumn('searchQuantity', $event)"
                    placeholder="Search" style="width: 5rem" />
                  <i *ngIf="inputQuantity.value" class="pi pi-times cursor-pointer"
                    (click)="inputQuantity.value = '';onClearFilter('searchQuantity')"></i>
                </span>
              </th>
              <th>
                <span class="p-input-icon-right">
                  <input #inputArrival type="text" pInputText (keyup)="onFilterColumn('searchArrival', $event)"
                    placeholder="Search" style="width: 5rem" />
                  <i *ngIf="inputArrival.value" class="pi pi-times cursor-pointer"
                    (click)="inputArrival.value = '';onClearFilter('searchArrival')"></i>
                </span>
              </th>
              <th>
                <span class="p-input-icon-right">
                  <input #inputInspection type="text" pInputText (keyup)="onFilterColumn('searchInspection', $event)"
                    placeholder="Search" style="width: 5rem" />
                  <i *ngIf="inputInspection.value" class="pi pi-times cursor-pointer"
                    (click)="inputInspection.value = '';onClearFilter('searchInspection')"></i>
                </span>
              </th>
              <th>
                <span class="p-input-icon-right">
                  <input #inputCreater type="text" pInputText (keyup)="onFilterColumn('searchCreater', $event)"
                    placeholder="Search" style="width: 5rem" />
                  <i *ngIf="inputCreater.value" class="pi pi-times cursor-pointer"
                    (click)="inputCreater.value = '';onClearFilter('searchCreater')"></i>
                </span>
              </th>
              <th>
                <span class="p-input-icon-right">
                  <input #inputStateName type="text" pInputText (keyup)="onFilterColumn('searchStateName', $event)"
                    placeholder="Search" style="width: 5rem" />
                  <i *ngIf="inputStateName.value" class="pi pi-times cursor-pointer"
                    (click)="inputStateName.value = '';onClearFilter('searchStateName')"></i>
                </span>
              </th>

              <th></th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-report>
            <tr>
              <td>{{ report.seq }}</td>
              <td>
                {{ report.invNo }}
              </td>
              <td>
                {{ report.qty }}
              </td>
              <td>
                {{ report.arrival }}
              </td>

              <td>
                {{ report.inspection }}
              </td>
              <td>
                {{ report.createBy }}
              </td>
              <td>
                <p class="text-status">{{ report.stateName }}</p>
              </td>
              <td>
                <div class="flex gap-1">
                  <button pButton class="p-button-text" (click)="setReportManageMenu(report);menu.toggle($event)">
                    <i class="pi pi-ellipsis-v"></i>
                  </button>
                  <p-menu #menu [model]="reportManageMenu" [popup]="true" appendTo="body"></p-menu>
                </div>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="7">ไม่พบข้อมูล</td>
            </tr>
          </ng-template>
          <ng-template pTemplate="loadingbody">
            <tr>
              <td colspan="7">กำลังโหลดข้อมูล....</td>
            </tr>
          </ng-template>
      </p-table>
      <p-paginator (onPageChange)="onPageChange($event)" [first]="first" [rows]="rows"
          [totalRecords]="totalRecords" [rowsPerPageOptions]="[5, 10, 50]"></p-paginator>
    </div>
  </div>
</div>
<div class="flex justify-content-center mt-4">
  <button class="px-5 p-button-outlined" pButton [routerLink]="['/contract',contractId]">กลับสู่หน้าหลัก</button>
</div>
<p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle"></p-confirmDialog>
<p-dialog [(visible)]="display" [modal]="true" [style]="{width: '80vw'}" [maximizable]="false" [draggable]="false"
  [resizable]="false" (onHide)="onHide()">
  <!-- <div id="outerContainer"> -->
  <div class="pdf-container">
    <pdf-viewer [src]="src" [rotation]="0" [original-size]="false" [show-all]="true"
      style="width: 100%; height: 600px;"></pdf-viewer>
  </div>
  <!-- </div> -->
</p-dialog>
