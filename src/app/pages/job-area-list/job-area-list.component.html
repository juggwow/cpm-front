<div class="mt-5">
    <p class="font-bold" style="font-size: 24px">ตรวจสอบมาตรฐานงานก่อสร้าง</p>
    <p-breadcrumb
        [style]="{ background: 'none', border: 'none' }"
        [model]="menuitems"
    ></p-breadcrumb>
</div>

<div class="mt-5" style="font-family: 'Noto Sans'">
    <p-card>
        <div class="flex align-items-center justify-content-between">
            <div class="map-header-left text-4xl font-bold">
                <p>{{ jobsDetail?.jobName }}</p>
            </div>
            <div class="map-header-right">
                <p class="font-bold text-2xl">{{ jobsDetail?.wbs }}</p>
                <p class="font-normal" style="font-size: 18px; color: #a9a9a9">
                    D1-แล้วเสร็จ-ตรวจสอบพัสดุค่าใช้จ่าย
                </p>
            </div>
        </div>

        <div class="flex align-items-center justify-content-between pb-3 mt-5">
            <!-- MenuBar -->
            <div>
                <p-tabMenu
                    *ngIf="activeItem"
                    [model]="items"
                    [activeItem]="activeItem"
                ></p-tabMenu>
            </div>

            <!-- click to add new item (modal) -->
            <div class="flex">
                <button
                    (click)="showModalDialog($event)"
                    pButton
                    pRipple
                    type="button"
                    label="เพิ่มเสางาน"
                    [style]="{ color: '#7718BC' }"
                    class="p-button-outlined button-height button-height__overline-style"
                    icon="pi pi-check-square"
                ></button>

                <!-- Modal -->
                <p-dialog
                    [header]="dialogTitle"
                    [(visible)]="editDialogShow"
                    [modal]="true"
                    [style]="{ width: '50vw', height: '75vh' }"
                    [maximizable]="true"
                    [baseZIndex]="10000"
                    [draggable]="false"
                    [resizable]="false"
                    class="flex flex-column"
                >
                    <div class="flex flex-column">
                        <span>เลือกประเภทหัวเสา / พื้นที่ตรวจนับ</span>
                        <div
                            class="flex align-items-center justify-content-between mt-3"
                        >
                            <div class="w-full">
                                <p-dropdown
                                    [options]="jobAreaTypes"
                                    [(ngModel)]="jobAreaType"
                                    placeholder="เลือกประเภทหัวเสา | พื้นที่"
                                    optionLabel="jobAreaType"
                                ></p-dropdown>

                                <span
                                    class="text-red-500 ml-1"
                                    [class.disabled]="jobAreaType"
                                >
                                    กรุณาเลือกประเภทหัวเสา
                                </span>
                            </div>
                            <div>
                                <img
                                    [style]="{
                                        width: '50px',
                                        height: '45px'
                                    }"
                                    class="ml-3"
                                    *ngIf="jobAreaType?.jobAreaType"
                                    [src]="
                                        'assets/img/job_area_type/' +
                                        jobAreaType?.jobAreaType +
                                        '.png'
                                    "
                                    alt=""
                                />
                            </div>
                        </div>
                        <span class="mt-3"
                            >รายละเอียดเสา / พื้นที่ตรวจนับ เพิ่มเติม</span
                        >
                        <textarea
                            class="mt-3"
                            rows="5"
                            placeholder="ระบุรายละเอียดเพิ่มเติม"
                            pInputTextarea
                            [(ngModel)]="detail"
                            [autoResize]="true"
                            [autofocus]="true"
                        ></textarea>

                        <span class="mt-3">ลำดับเสา / พื้นที่ตรวจนับ</span>
                        <p-dropdown
                            [style]="{ width: '100%' }"
                            class="mt-3"
                            appendTo="body"
                            [options]="areaSeqList"
                            [(ngModel)]="areaSeq"
                            placeholder="ระบุลำดับ"
                        ></p-dropdown>

                        <span
                            class="text-red-500 ml-1"
                            [class.disabled]="areaSeq"
                        >
                            กรุณาเลือกระบุลำดับ
                        </span>

                        <ng-template pTemplate="footer">
                            <p-button
                                icon="pi pi-check"
                                (click)="editDialogShow = false"
                                label="Yes"
                                class="p-button-text"
                            ></p-button>
                            <p-button
                                icon="pi pi-times"
                                (click)="editDialogShow = false"
                                label="No"
                            ></p-button>
                        </ng-template>

                        <!-- button ตกลง button ลบ -->
                        <div
                            class="flex aling-items-center justify-content-center"
                        >
                            <p-button
                                [disabled]="!editJobAreaId"
                                [style]="{
                                    'padding-left': ' 5rem',
                                    'padding-right': '5rem',
                                    'background-color': '#fff',
                                    color: '#7718BC'
                                }"
                                *ngIf="editJobAreaId"
                                class="text-center mt-3"
                                (click)="deleteJobArea()"
                                >ลบ</p-button
                            >
                            <p-button
                                [disabled]="!areaSeq && !jobAreaType"
                                [style]="{
                                    'padding-left': ' 5rem',
                                    'padding-right': '5rem',
                                    'background-color': '#7718BC'
                                }"
                                class="text-center mt-3 ml-3"
                                (click)="submitJobArea()"
                                >ตกลง</p-button
                            >
                        </div>
                    </div>
                </p-dialog>

                <!-- click to link to another page -->
                <button
                    [routerLink]="['/picture']"
                    pButton
                    pRipple
                    type="button"
                    label="ภาพงานทั้งหมด"
                    [style]="{ color: '#7718BC' }"
                    class="ml-3 p-button-outlined button-height button-height__overline-style"
                    icon="pi pi-instagram"
                ></button>
            </div>
        </div>

        <div class="card mt-5">
            <p-table [value]="jobAreaList" [showCurrentPageReport]="true">
                <ng-template pTemplate="header">
                    <tr class="table-header_background-none">
                        <th></th>
                        <th>ลำดับ</th>
                        <th>ประเภท</th>
                        <th>รายละเอียด</th>
                        <th>สถานะ</th>
                        <th>สัญลักษณ์บ่งชี้</th>
                        <th></th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-jobArea>
                    <tr
                        (click)="routesToDetail(jobArea.id)"
                        class="table-header_background-none"
                    >
                        <td class="text-center">
                            <img
                                *ngIf="jobArea?.jobAreaType?.jobAreaType"
                                [src]="
                                    'assets/img/job_area_type/' +
                                    jobArea.jobAreaType.jobAreaType +
                                    '.png'
                                "
                                alt=""
                            />
                        </td>
                        <td class="text-center">
                            {{ jobArea.areaSeq }}
                        </td>
                        <td class="text-center">
                            {{ jobArea.jobAreaType?.jobAreaType }}
                        </td>
                        <td class="text-center">
                            {{ jobArea.detail }}
                        </td>
                        <td class="text-center">
                            {{ jobArea.status }}
                        </td>
                        <td class="text-center">
                            {{ jobArea.indecators }}
                        </td>
                        <td class="text-center">
                            <!-- Edit Modal Button -->
                            <button
                                (click)="showModalDialog($event, jobArea)"
                                pButton
                                pRipple
                                type="button"
                                icon="pi pi-pencil"
                                class="p-button-rounded p-button-outlined editbutton__background-color"
                            ></button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>

            <div class="flex justify-content-center mt-5">
                <p class="flex align-items-center ml-3 p-paginat__line-height">
                    แสดงจำนวนเสา
                </p>

                <!-- pagination button -->
                <p-paginator
                    (onPageChange)="paginate($event)"
                    [first]="first"
                    [rows]="rows"
                    [totalRecords]="totalRecords"
                    [rowsPerPageOptions]="[10, 20, 50, 100]"
                ></p-paginator>
            </div>

            <!-- footer indicator icon -->
            <div
                class="flex align-items-center justify-content-center text-center mt-5"
            >
                <div class="flex align-items-center">
                    <img
                        src="assets/img/job_area_indicator/refresh.png"
                        alt=""
                    />
                    <p class="footer-indicator__color-change">กำลังดำเนินการ</p>
                </div>
                <div class="flex align-items-center">
                    <img src="assets/svg/info-yellow.svg" alt="" />
                    <p class="footer-indicator__color-change">
                        พัสดุคลาดเคลื่อน
                    </p>
                </div>
                <div class="flex align-items-center">
                    <img
                        src="assets/svg/cross-danger.svg"
                        width="24px"
                        [ngStyle]="{ objectFit: 'none' }"
                        alt=""
                    />
                    <p class="footer-indicator__color-change">
                        ผิดมาตรฐานงานก่อสร้าง
                    </p>
                </div>
                <div class="flex align-items-center">
                    <img src="assets/svg/check-success.svg" alt="" />
                    <p class="footer-indicator__color-change">
                        พัสดุและมาตรฐานถูกต้อง
                    </p>
                </div>
                <div class="flex align-items-center">
                    <img
                        src="assets/img/job_area_indicator/upload.png"
                        alt=""
                    />
                    <p class="footer-indicator__color-change">
                        เทปูนหุ้มโคนเสาไฟฟ้า
                    </p>
                </div>
            </div>
        </div>
    </p-card>
</div>
